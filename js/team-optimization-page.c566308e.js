"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[362],{1078:function(e,t,a){a.d(t,{Uu:function(){return n},kS:function(){return r},m6:function(){return c}});a(14602);var l=a(61565);a(30789),a(60933);function n(e,t){const l=new Worker(new URL(a.p+a.u(806),a.b));return new Promise((a,n)=>{l.onmessage=function(n){const o=n.data.type;if("ready"===o)l.postMessage({input:e,artifacts:t});else if("result"===o){const e=n.data.data.result;l.terminate(),a(e)}},l.onerror=function(e){n(e)}})}a(96484);var o=a(8402);function r(e,t,l=3e5){const n=new Worker(new URL(a.p+a.u(453),a.b)),r=(0,o.A4)(e);return new Promise((e,a)=>{const o=setTimeout(()=>{a("计算超时")},l);n.onmessage=l=>{if("ready"===l.data.type)n.postMessage({potentialFunctionInterface:r,artifacts:t});else if("progress"===l.data.type)console.log(`计算进度: ${l.data.processed}/${l.data.total} (${l.data.percentage}%)`);else if("error"===l.data.type)clearTimeout(o),a("计算发生错误："+l.data.message);else if("results"===l.data.type){const t=l.data.data.results;clearTimeout(o),e(t)}},n.onerror=e=>{a("计算发生错误："+e.message),clearTimeout(o)}}).finally(()=>{n.terminate()})}async function c(e,t,a,n){const o=await(0,l.N)();return o.CommonInterface.get_artifacts_rank_by_character(e,t,a,n)}},5588:function(e,t,a){a.r(t),a.d(t,{default:function(){return $}});var l=a(74240),n=a(73577),o=a(74061),r=a(73517),c=(a(69377),a(40079)),i=(a(55324),a(34995)),u=(a(83620),a(76173)),s=(a(45076),a(10700)),m=(a(99482),a(84182)),d=(a(45930),a(37241)),p=(a(38222),a(14602),a(55267)),f=a(1078),v=a(13686),k=a(24821),g=a(10644),h=a(74025),y=a(73399),V=a(73427),B=a(53438),w=a(36254),N=a(61565),b=a(8402),x=a(22414),E=a(59360),C=a(75841),A=a(44550),_=a(53832);const S=e=>((0,o.pushScopeId)("data-v-8e2cf5c8"),e=e(),(0,o.popScopeId)(),e),z={key:1,style:{padding:"0 20px"}},M={style:{"margin-bottom":"12px"}},P={style:{display:"flex","justify-content":"space-between","align-items":"center"},class:"member-header"},T={class:"team-title"},D={class:"common-title2"},U={class:"common-title2"},L={class:"result-item-top"},I=S(()=>(0,o.createElementVNode)("div",{class:"result-item-buttons"},null,-1)),F={class:"result-item-content"},H={key:1,style:{display:"flex","justify-content":"center"}};var j=(0,o.defineComponent)({__name:"TeamOptimizationPage",async setup(e){let t,a;const{t:S}=(0,_.s9)(),j=(0,V.D)(),R=(0,B.S)(),Y=(0,w.E1)(),$=([t,a]=(0,o.withAsyncContext)(()=>(0,N.N)()),t=await t,a(),t),O=(0,o.ref)([null]),K=(0,o.ref)([0]),W=8;function q(){O.value.length!==W?(O.value.push(null),K.value.push(0)):(0,l.nk)({message:"最多支持8个成员",type:"error"})}function G(e){1!==O.value.length&&(O.value.splice(e,1),K.value.splice(e,1))}const J=(0,o.computed)(()=>{let e=[];for(let t of O.value.values())if(t){const a=R.presets.value[t];a&&e.push(a)}return e}),Q=(0,o.ref)([]),X=(0,o.ref)(0),Z=(0,o.computed)(()=>0===Q.value.length?null:Q.value[X.value]);function ee(e){X.value=e-1}const te=(0,o.ref)(!1),ae=(0,o.ref)(null);function le(e){let t=[];if(Z.value){const a=Object.values(Z.value[e]),l=[];for(let e of a){const t=j.artifacts.value.get(e);t&&l.push(t)}t=l.map(e=>(0,p.MK)(e))}return{character:J.value[e].item.character,weapon:J.value[e].item.weapon,buffs:J.value[e].item.buffs,artifacts:t}}async function ne(e){const t=le(e);ae.value=await $.CommonInterface.get_attribute(t),te.value=!0}function oe(e){j.toggleArtifact(e)}const re=(0,o.computed)(()=>{let e=[];for(let t of j.artifacts.value.values())t.level>=16&&!t.omit&&e.push(t);return e}),ce=(0,o.computed)(()=>re.value.map(p.MK)),ie=(0,o.computed)(()=>J.value.map(e=>(0,v.x2)(e.item))),ue={mva_step:5,work_space:1e3,max_re_optimize:5,max_search:1e6,count:1e3},se=(0,o.computed)(()=>({single_interfaces:ie.value,weights:K.value,hyper_param:ue}));function me(){const e=J.value.length===O.value.length;if(!e)return void(0,l.nk)({message:"请选择计算预设",type:"error"});const t=(0,b.A4)(se.value),a=ce.value,o=n.Ks.service({text:S("misc","monaCalculatingTeam"),lock:!0,fullscreen:!0});(0,f.Uu)(t,a).then(e=>{Q.value=e.artifacts,X.value=0}).catch(e=>{var t;(0,l.nk)({message:`计算过程发生错误：${null!==(t=e.message)&&void 0!==t?t:e}`,type:"error"}),console.error(e)}).finally(()=>{o.close()})}return(0,o.watch)(()=>Y.currentAccountId.value,()=>{O.value=[null],K.value=[0],Q.value=[],X.value=0}),(e,t)=>{const a=d.x0,l=m.pw,n=s.S2,p=u.B8,f=i.uD,v=c.lq,V=r.S2;return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(l,{title:(0,o.unref)(S)("misc.panel"),modelValue:te.value,"onUpdate:modelValue":t[0]||(t[0]=e=>te.value=e),size:(0,o.unref)(k.U)?"30%":"100%"},{default:(0,o.withCtx)(()=>[ae.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",z,[(0,o.createVNode)((0,o.unref)(y.A),{attribute:ae.value},null,8,["attribute"])])):((0,o.openBlock)(),(0,o.createBlock)(a,{key:0},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)("In theory, you should not see this")]),_:1}))]),_:1},8,["title","modelValue","size"]),(0,o.createVNode)(V,{gutter:16},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(f,{md:6,sm:24,class:"mona-scroll-hidden left"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("div",M,[(0,o.createVNode)(n,{type:"primary",icon:(0,o.unref)(x.A),onClick:me},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(S)("teamPage.start")),1)]),_:1},8,["icon"]),(0,o.createVNode)(n,{icon:(0,o.unref)(E.A),onClick:q},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(S)("teamPage.add")),1)]),_:1},8,["icon"])]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(O.value,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"member-item"},[(0,o.createElementVNode)("div",P,[(0,o.createElementVNode)("p",T,(0,o.toDisplayString)((0,o.unref)(S)("teamPage.member"))+(0,o.toDisplayString)(t+1),1),(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{circle:"",text:"",icon:(0,o.unref)(C.A),onClick:e=>G(t),style:{color:"white"}},null,8,["icon","onClick"])])]),(0,o.createElementVNode)("p",D,(0,o.toDisplayString)((0,o.unref)(S)("misc.preset")),1),(0,o.createVNode)(h.A,{modelValue:O.value[t],"onUpdate:modelValue":e=>O.value[t]=e},null,8,["modelValue","onUpdate:modelValue"]),(0,o.createElementVNode)("p",U,(0,o.toDisplayString)((0,o.unref)(S)("teamPage.weight")),1),(0,o.createVNode)(p,{modelValue:K.value[t],"onUpdate:modelValue":e=>K.value[t]=e,min:0,max:1,step:.01,"show-input":!0,style:{"padding-left":"8px"}},null,8,["modelValue","onUpdate:modelValue","step"])]))),128))]),_:1}),(0,o.createVNode)(f,{md:18,sm:24,class:"mona-scroll-hidden right"},{default:(0,o.withCtx)(()=>[(0,o.unref)(Z)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(v,{"model-value":X.value+1,"onUpdate:modelValue":ee,min:1,max:Q.value.length,style:{"margin-bottom":"12px"}},null,8,["model-value","max"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(Z),(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"result-item"},[(0,o.createElementVNode)("div",L,[(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{icon:(0,o.unref)(A.A),circle:"",text:"",title:(0,o.unref)(S)("teamPage.showStat"),onClick:e=>ne(t)},null,8,["icon","title","onClick"])]),I]),(0,o.createElementVNode)("div",F,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(Z)[t],e=>((0,o.openBlock)(),(0,o.createBlock)(g.A,{key:e,item:(0,o.unref)(j).artifacts.value.get(e),buttons:!0,"lock-button":!0,"delete-button":!1,"edit-button":!1,onToggle:t=>oe(e)},null,8,["item","onToggle"]))),128))])]))),128))],64)):((0,o.openBlock)(),(0,o.createElementBlock)("div",H,[(0,o.createVNode)(a)]))]),_:1})]),_:1})])}}}),R=a(66262);const Y=(0,R.A)(j,[["__scopeId","data-v-8e2cf5c8"]]);var $=Y},10644:function(e,t,a){a.d(t,{A:function(){return x}});var l=a(10700),n=(a(99482),a(14602),a(74061)),o=a(91420),r=a(37073),c=a(69620),i=a(57797),u=a(75841),s=a(53452),m=a(89133),d=a(53832);const p={class:"up"},f={class:"name"},v={key:1,class:"buttons"},k={key:2,class:"extra fs-12"},g={class:"down"},h=["src"],y={class:"detail-div"},V={class:"main-tag"};function B(){return{setName:"luckyDog",position:"cup",mainTag:{name:"attackPercentage",value:.1},normalTags:[{name:"defendStatic",value:20},{name:"attackPercentage",value:.3},{name:"attackPercentage",value:.3},{name:"attackPercentage",value:.3}],level:20,star:5,omit:!1}}var w=(0,n.defineComponent)({__name:"ArtifactDisplay",props:{item:{default:B},selectable:{type:Boolean,default:!1},extra:{default:""},buttons:{type:Boolean,default:!1},deleteButton:{type:Boolean,default:!1},lockButton:{type:Boolean,default:!0},editButton:{type:Boolean,default:!1},showBack:{type:Boolean,default:!1},backValue:{default:1}},emits:["click","toggle","delete","edit"],setup(e,{emit:t}){const a=e,{t:B,ta:w}=(0,d.s9)(),N=(0,n.computed)(()=>{let e=o.Yj[a.item.setName];if(!e)throw"no artifact";let t="not exist";return e[a.item.position]&&(t=w(e[a.item.position].text),Object.prototype.hasOwnProperty.call(a.item,"level")?t+="+"+a.item.level:t+="+??"),t}),b=(0,n.computed)(()=>{let e=o.Yj[a.item.setName];if(!e)throw"no artifact";if(e[a.item.position])return e[a.item.position].url;throw"error no position"}),x=(0,n.computed)(()=>(0,m.wr)(a.item.mainTag.name,a.item.mainTag.value)),E=(0,n.computed)(()=>{let e=[];for(let t of a.item.normalTags)e.push((0,m.wr)(t.name,t.value));return e}),C=(0,n.computed)(()=>{let e=a.item.star;return r.A[e-1]});function A(){a.selectable&&t("click")}return(e,o)=>{const r=l.S2;return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(["artifact",{selectable:a.selectable,omit:a.item.omit}]),onClick:A},[(0,n.createElementVNode)("div",p,[a.showBack?((0,n.openBlock)(),(0,n.createElementBlock)("div",{key:0,style:(0,n.normalizeStyle)({width:100*a.backValue+"%"}),class:"back"},null,4)):(0,n.createCommentVNode)("",!0),(0,n.createElementVNode)("span",f,(0,n.toDisplayString)((0,n.unref)(N)),1),a.buttons?((0,n.openBlock)(),(0,n.createElementBlock)("div",v,[a.lockButton?((0,n.openBlock)(),(0,n.createBlock)(r,{key:0,icon:a.item.omit?(0,n.unref)(c.A):(0,n.unref)(i.A),circle:"",size:"small",text:"",title:a.item.omit?(0,n.unref)(B)("misc.unlock"):(0,n.unref)(B)("misc.lock"),class:"mybutton",onClick:o[0]||(o[0]=(0,n.withModifiers)(e=>t("toggle"),["stop"]))},null,8,["icon","title"])):(0,n.createCommentVNode)("",!0),a.deleteButton?((0,n.openBlock)(),(0,n.createBlock)(r,{key:1,icon:(0,n.unref)(u.A),circle:"",size:"small",text:"",title:(0,n.unref)(B)("misc.del"),class:"mybutton",onClick:o[1]||(o[1]=(0,n.withModifiers)(e=>t("delete"),["stop"]))},null,8,["icon","title"])):(0,n.createCommentVNode)("",!0),a.editButton?((0,n.openBlock)(),(0,n.createBlock)(r,{key:2,icon:(0,n.unref)(s.A),circle:"",size:"small",text:"",title:(0,n.unref)(B)("misc.edit"),class:"mybutton",onClick:o[2]||(o[2]=(0,n.withModifiers)(e=>t("edit"),["stop"]))},null,8,["icon","title"])):(0,n.createCommentVNode)("",!0)])):(0,n.createCommentVNode)("",!0),a.extra?((0,n.openBlock)(),(0,n.createElementBlock)("span",k,(0,n.toDisplayString)(a.extra),1)):(0,n.createCommentVNode)("",!0)]),(0,n.createElementVNode)("div",g,[(0,n.createElementVNode)("div",null,[(0,n.createElementVNode)("img",{src:(0,n.unref)(b),alt:"图",class:"myimage",style:(0,n.normalizeStyle)({background:(0,n.unref)(C)})},null,12,h)]),(0,n.createElementVNode)("div",y,[(0,n.createElementVNode)("p",V,(0,n.toDisplayString)((0,n.unref)(x)),1),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(E),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("p",{key:t,class:"sec-tag"},(0,n.toDisplayString)(e),1))),128))])])],2)}}}),N=a(66262);const b=(0,N.A)(w,[["__scopeId","data-v-383da2e2"]]);var x=b},37073:function(e,t){t.A=["rgb(125,127,131)","rgb(108,168,139)","rgb(86,155,175)","rgb(177,135,195)","rgb(211,159,81)"]},53452:function(e,t,a){var l=a(74061);const n={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},o=(0,l.createElementVNode)("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z"},null,-1),r=(0,l.createElementVNode)("path",{fill:"currentColor",d:"m469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"},null,-1),c=[o,r];function i(e,t){return(0,l.openBlock)(),(0,l.createElementBlock)("svg",n,c)}t.A={name:"ep-edit",render:i}},57797:function(e,t,a){var l=a(74061);const n={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},o=(0,l.createElementVNode)("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32H224zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96z"},null,-1),r=(0,l.createElementVNode)("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32zm192-160v-64a192 192 0 1 0-384 0v64h384zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64z"},null,-1),c=[o,r];function i(e,t){return(0,l.openBlock)(),(0,l.createElementBlock)("svg",n,c)}t.A={name:"ep-lock",render:i}},61565:function(e,t,a){a.d(t,{N:function(){return o}});a(14602);async function l(){const e=await Promise.all([a.e(233),a.e(855),a.e(136)]).then(a.bind(a,52233));return e}const n=l();async function o(){return await n}},69620:function(e,t,a){var l=a(74061);const n={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},o=(0,l.createElementVNode)("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32H224zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96z"},null,-1),r=(0,l.createElementVNode)("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32zm178.304-295.296A192.064 192.064 0 0 0 320 320v64h352l96 38.4V448H256V320a256 256 0 0 1 493.76-95.104l-59.456 23.808z"},null,-1),c=[o,r];function i(e,t){return(0,l.openBlock)(),(0,l.createElementBlock)("svg",n,c)}t.A={name:"ep-unlock",render:i}},74025:function(e,t,a){a.d(t,{A:function(){return i}});var l=a(74061),n=a(50887),o=(a(81826),a(8365),a(14602),a(53438)),r={__name:"SelectPreset",props:{modelValue:String},setup(e){const t=(0,o.S)(),a=(0,l.computed)(()=>{let e=[];for(let a of t.allFlat.value)e.push(a.name);return e});return(t,o)=>{const r=n.P9,c=n.AV;return(0,l.openBlock)(),(0,l.createBlock)(c,{"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t.$emit("update:modelValue",e))},{default:(0,l.withCtx)(()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(a),e=>((0,l.openBlock)(),(0,l.createBlock)(r,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["model-value"])}}};const c=r;var i=c}}]);