"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[362],{1078:function(e,t,a){a.d(t,{Uu:function(){return n},kS:function(){return r},m6:function(){return c}});a(14602);var l=a(61565);a(30789),a(60933);function n(e,t){const l=new Worker(new URL(a.p+a.u(806),a.b));return new Promise((a,n)=>{l.onmessage=function(n){const o=n.data.type;if("ready"===o)l.postMessage({input:e,artifacts:t});else if("result"===o){const e=n.data.data.result;l.terminate(),a(e)}},l.onerror=function(e){n(e)}})}a(96484);var o=a(8402);function r(e,t,l=3e5){const n=new Worker(new URL(a.p+a.u(453),a.b)),r=(0,o.A4)(e);return new Promise((e,a)=>{const o=setTimeout(()=>{a("计算超时")},l);n.onmessage=l=>{if("ready"===l.data.type)n.postMessage({potentialFunctionInterface:r,artifacts:t});else if("progress"===l.data.type)console.log(`计算进度: ${l.data.processed}/${l.data.total} (${l.data.percentage}%)`);else if("error"===l.data.type)clearTimeout(o),a("计算发生错误："+l.data.message);else if("results"===l.data.type){const t=l.data.data.results;clearTimeout(o),e(t)}},n.onerror=e=>{a("计算发生错误："+e.message),clearTimeout(o)}}).finally(()=>{n.terminate()})}async function c(e,t,a,n){const o=await(0,l.N)();return o.CommonInterface.get_artifacts_rank_by_character(e,t,a,n)}},5588:function(e,t,a){a.r(t),a.d(t,{default:function(){return R}});var l=a(74240),n=a(73577),o=a(74061),r=a(73517),c=(a(69377),a(40079)),u=(a(55324),a(34995)),s=(a(83620),a(76173)),i=(a(45076),a(10700)),m=(a(99482),a(84182)),d=(a(45930),a(37241)),p=(a(38222),a(14602),a(55267)),f=a(1078),v=a(13686),g=a(24821),k=a(10644),h=a(74025),y=a(73399),V=a(73427),w=a(53438),B=a(36254),x=a(61565),N=a(8402),_=a(22414),b=a(59360),C=a(75841),E=a(44550),S=a(53832);const A=e=>((0,o.pushScopeId)("data-v-8e2cf5c8"),e=e(),(0,o.popScopeId)(),e),U={key:1,style:{padding:"0 20px"}},T={style:{"margin-bottom":"12px"}},P={style:{display:"flex","justify-content":"space-between","align-items":"center"},class:"member-header"},D={class:"team-title"},I={class:"common-title2"},F={class:"common-title2"},L={class:"result-item-top"},$=A(()=>(0,o.createElementVNode)("div",{class:"result-item-buttons"},null,-1)),z={class:"result-item-content"},M={key:1,style:{display:"flex","justify-content":"center"}};var j=(0,o.defineComponent)({__name:"TeamOptimizationPage",async setup(e){let t,a;const{t:A}=(0,S.s9)(),j=(0,V.D)(),K=(0,w.S)(),O=(0,B.E1)(),R=([t,a]=(0,o.withAsyncContext)(()=>(0,x.N)()),t=await t,a(),t),W=(0,o.ref)([null]),q=(0,o.ref)([0]),G=8;function H(){W.value.length!==G?(W.value.push(null),q.value.push(0)):(0,l.nk)({message:"最多支持8个成员",type:"error"})}function J(e){1!==W.value.length&&(W.value.splice(e,1),q.value.splice(e,1))}const Q=(0,o.computed)(()=>{let e=[];for(let t of W.value.values())if(t){const a=K.presets.value[t];a&&e.push(a)}return e}),X=(0,o.ref)([]),Y=(0,o.ref)(0),Z=(0,o.computed)(()=>0===X.value.length?null:X.value[Y.value]);function ee(e){Y.value=e-1}const te=(0,o.ref)(!1),ae=(0,o.ref)(null);function le(e){let t=[];if(Z.value){const a=Object.values(Z.value[e]),l=[];for(let e of a){const t=j.artifacts.value.get(e);t&&l.push(t)}t=l.map(e=>(0,p.MK)(e))}return{character:Q.value[e].item.character,weapon:Q.value[e].item.weapon,buffs:Q.value[e].item.buffs,artifacts:t}}async function ne(e){const t=le(e);ae.value=await R.CommonInterface.get_attribute(t),te.value=!0}function oe(e){j.toggleArtifact(e)}const re=(0,o.computed)(()=>{let e=[];for(let t of j.artifacts.value.values())t.level>=16&&!t.omit&&e.push(t);return e}),ce=(0,o.computed)(()=>re.value.map(p.MK)),ue=(0,o.computed)(()=>Q.value.map(e=>(0,v.x2)(e.item))),se={mva_step:5,work_space:1e3,max_re_optimize:5,max_search:1e6,count:1e3},ie=(0,o.computed)(()=>({single_interfaces:ue.value,weights:q.value,hyper_param:se}));function me(){const e=Q.value.length===W.value.length;if(!e)return void(0,l.nk)({message:"请选择计算预设",type:"error"});const t=(0,N.A4)(ie.value),a=ce.value,o=n.Ks.service({text:A("misc","monaCalculatingTeam"),lock:!0,fullscreen:!0});(0,f.Uu)(t,a).then(e=>{X.value=e.artifacts,Y.value=0}).catch(e=>{var t;(0,l.nk)({message:`计算过程发生错误：${null!==(t=e.message)&&void 0!==t?t:e}`,type:"error"}),console.error(e)}).finally(()=>{o.close()})}return(0,o.watch)(()=>O.currentAccountId.value,()=>{W.value=[null],q.value=[0],X.value=[],Y.value=0}),(e,t)=>{const a=d.x0,l=m.pw,n=i.S2,p=s.B8,f=u.uD,v=c.lq,V=r.S2;return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(l,{title:(0,o.unref)(A)("misc.panel"),modelValue:te.value,"onUpdate:modelValue":t[0]||(t[0]=e=>te.value=e),size:(0,o.unref)(g.U)?"30%":"100%"},{default:(0,o.withCtx)(()=>[ae.value?((0,o.openBlock)(),(0,o.createElementBlock)("div",U,[(0,o.createVNode)((0,o.unref)(y.A),{attribute:ae.value},null,8,["attribute"])])):((0,o.openBlock)(),(0,o.createBlock)(a,{key:0},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)("In theory, you should not see this")]),_:1}))]),_:1},8,["title","modelValue","size"]),(0,o.createVNode)(V,{gutter:16},{default:(0,o.withCtx)(()=>[(0,o.createVNode)(f,{md:6,sm:24,class:"mona-scroll-hidden left"},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("div",T,[(0,o.createVNode)(n,{type:"primary",icon:(0,o.unref)(_.A),onClick:me},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(A)("teamPage.start")),1)]),_:1},8,["icon"]),(0,o.createVNode)(n,{icon:(0,o.unref)(b.A),onClick:H},{default:(0,o.withCtx)(()=>[(0,o.createTextVNode)((0,o.toDisplayString)((0,o.unref)(A)("teamPage.add")),1)]),_:1},8,["icon"])]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(W.value,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"member-item"},[(0,o.createElementVNode)("div",P,[(0,o.createElementVNode)("p",D,(0,o.toDisplayString)((0,o.unref)(A)("teamPage.member"))+(0,o.toDisplayString)(t+1),1),(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{circle:"",text:"",icon:(0,o.unref)(C.A),onClick:e=>J(t),style:{color:"white"}},null,8,["icon","onClick"])])]),(0,o.createElementVNode)("p",I,(0,o.toDisplayString)((0,o.unref)(A)("misc.preset")),1),(0,o.createVNode)(h.A,{modelValue:W.value[t],"onUpdate:modelValue":e=>W.value[t]=e},null,8,["modelValue","onUpdate:modelValue"]),(0,o.createElementVNode)("p",F,(0,o.toDisplayString)((0,o.unref)(A)("teamPage.weight")),1),(0,o.createVNode)(p,{modelValue:q.value[t],"onUpdate:modelValue":e=>q.value[t]=e,min:0,max:1,step:.01,"show-input":!0,style:{"padding-left":"8px"}},null,8,["modelValue","onUpdate:modelValue","step"])]))),128))]),_:1}),(0,o.createVNode)(f,{md:18,sm:24,class:"mona-scroll-hidden right"},{default:(0,o.withCtx)(()=>[(0,o.unref)(Z)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(v,{"model-value":Y.value+1,"onUpdate:modelValue":ee,min:1,max:X.value.length,style:{"margin-bottom":"12px"}},null,8,["model-value","max"]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(Z),(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"result-item"},[(0,o.createElementVNode)("div",L,[(0,o.createElementVNode)("div",null,[(0,o.createVNode)(n,{icon:(0,o.unref)(E.A),circle:"",text:"",title:(0,o.unref)(A)("teamPage.showStat"),onClick:e=>ne(t)},null,8,["icon","title","onClick"])]),$]),(0,o.createElementVNode)("div",z,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(Z)[t],e=>((0,o.openBlock)(),(0,o.createBlock)(k.A,{key:e,item:(0,o.unref)(j).artifacts.value.get(e),buttons:!0,"lock-button":!0,"delete-button":!1,"edit-button":!1,onToggle:t=>oe(e)},null,8,["item","onToggle"]))),128))])]))),128))],64)):((0,o.openBlock)(),(0,o.createElementBlock)("div",M,[(0,o.createVNode)(a)]))]),_:1})]),_:1})])}}}),K=a(66262);const O=(0,K.A)(j,[["__scopeId","data-v-8e2cf5c8"]]);var R=O},74025:function(e,t,a){a.d(t,{A:function(){return u}});var l=a(74061),n=a(50887),o=(a(81826),a(8365),a(14602),a(53438)),r={__name:"SelectPreset",props:{modelValue:String},setup(e){const t=(0,o.S)(),a=(0,l.computed)(()=>{let e=[];for(let a of t.allFlat.value)e.push(a.name);return e});return(t,o)=>{const r=n.P9,c=n.AV;return(0,l.openBlock)(),(0,l.createBlock)(c,{"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t.$emit("update:modelValue",e))},{default:(0,l.withCtx)(()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(a),e=>((0,l.openBlock)(),(0,l.createBlock)(r,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["model-value"])}}};const c=r;var u=c}}]);